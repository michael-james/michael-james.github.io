if (self.CavalryLogger) { CavalryLogger.start_js(["H0a3Q"]); }

__d('PagesMessagingMercuryChatTabActionKeys',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({REQUEST_GREETING_CONFIG:null,NOTIFY_GREETING_CONFIG_RECEIVED:null,SAY_HELLO:null});f.exports=h;}),null);
__d('PagesMessagingMercuryChatTabDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){'use strict';f.exports=new (c('ExplicitRegistrationDispatcher'))({strict:false});}),null);
__d('PagesMessagingMercuryChatTabActions',['PagesMessagingMercuryChatTabActionKeys','PagesMessagingMercuryChatTabDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h={requestGreetingConfig:function i(j){c('PagesMessagingMercuryChatTabDispatcher').dispatch({actionType:c('PagesMessagingMercuryChatTabActionKeys').REQUEST_GREETING_CONFIG,threadID:j});},notifyGreetingConfigReceived:function i(j,k){c('PagesMessagingMercuryChatTabDispatcher').dispatch({actionType:c('PagesMessagingMercuryChatTabActionKeys').NOTIFY_GREETING_CONFIG_RECEIVED,threadID:j,payload:k});},sayHello:function i(j){c('PagesMessagingMercuryChatTabDispatcher').dispatch({actionType:c('PagesMessagingMercuryChatTabActionKeys').SAY_HELLO,threadID:j});}};f.exports=h;}),null);
__d('PagesMessagingMercuryChatTabState',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('immutable').Record({pagesGreetingShouldShow:false,pagesGreetingContent:null,sayHelloMessage:null}));i=h&&h.prototype;function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d("XPagesSayHelloController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pages\/messaging\/say_hello\/",{});}),null);
__d('PagesMessagingMercuryChatTabStore',['invariant','PagesMessagingMercuryChatTabActionKeys','PagesMessagingMercuryChatTabActions','AsyncRequest','PagesMessagingMercuryChatTabDispatcher','FluxStore','Map','MercuryIDs','PagesMessagingMercuryChatTabState','XMercuryChatTabPagesGreetingConfigController','XPagesSayHelloController'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('FluxStore'));j=i&&i.prototype;function k(){j.constructor.call(this,c('PagesMessagingMercuryChatTabDispatcher'));this.$PagesMessagingMercuryChatTabStore1=new (c('Map'))();}k.prototype.getStateByThread=function(l){if(!this.$PagesMessagingMercuryChatTabStore1.has(l))this.$PagesMessagingMercuryChatTabStore1.set(l,new (c('PagesMessagingMercuryChatTabState'))());var m=this.$PagesMessagingMercuryChatTabStore1.get(l);m||h(0);return m;};k.prototype.__onDispatch=function(l){var m=l.actionType,n=l.payload,o=l.threadID,p=this.getStateByThread(o);p||h(0);switch(m){case c('PagesMessagingMercuryChatTabActionKeys').REQUEST_GREETING_CONFIG:this.$PagesMessagingMercuryChatTabStore2(o);break;case c('PagesMessagingMercuryChatTabActionKeys').SAY_HELLO:this.$PagesMessagingMercuryChatTabStore3(o);break;case c('PagesMessagingMercuryChatTabActionKeys').NOTIFY_GREETING_CONFIG_RECEIVED:this.$PagesMessagingMercuryChatTabStore4(o,this.$PagesMessagingMercuryChatTabStore5(n,p));break;}};k.prototype.$PagesMessagingMercuryChatTabStore2=function(l){var m=c('XMercuryChatTabPagesGreetingConfigController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(m).setMethod('POST').setData({page_id:c('MercuryIDs').getUserIDFromThreadID(l)}).setHandler(function(n){return c('PagesMessagingMercuryChatTabActions').notifyGreetingConfigReceived(l,n.payload);}).send();};k.prototype.$PagesMessagingMercuryChatTabStore3=function(l){var m=c('XPagesSayHelloController').getURIBuilder().getURI();new (c('AsyncRequest'))().setURI(m).setMethod('POST').setData({page_id:c('MercuryIDs').getUserIDFromThreadID(l)}).send();var n=this.getStateByThread(l);this.$PagesMessagingMercuryChatTabStore4(l,n.set('sayHelloMessage',null));};k.prototype.$PagesMessagingMercuryChatTabStore4=function(l,m){this.$PagesMessagingMercuryChatTabStore1.set(l,m);this.__emitChange();};k.prototype.$PagesMessagingMercuryChatTabStore5=function(l,m){return m.set('pagesGreetingShouldShow',l.shouldShow).set('pagesGreetingContent',l.content).set('sayHelloMessage',l.sayHelloMessage);};f.exports=new k();}),null);
__d('MercuryChatTabPagesGreetingContainer.react',['cx','fbt','MercuryMessages','PagesMessagingMercuryChatTabActions','PagesMessagingMercuryChatTabStore','React','StoreAndPropBasedStateMixin','XUIButton.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('React').PropTypes,k=c('React').createClass({displayName:'MercuryChatTabPagesGreetingContainer',propTypes:{threadID:j.string.isRequired},mixins:[c('StoreAndPropBasedStateMixin')(c('MercuryMessages'),c('PagesMessagingMercuryChatTabStore'))],statics:{calculateState:function l(m){var n=c('MercuryMessages').get().getCurrentlyLoadedMessages(m.threadID);if(n&&n.length>0)return {message:null,sayHelloMessage:null,shouldShow:false,shouldShowSayHello:false};var o=c('PagesMessagingMercuryChatTabStore').getStateByThread(m.threadID);return {shouldShow:o.pagesGreetingShouldShow&&o.pagesGreetingContent&&o.pagesGreetingContent.length>0,message:o.pagesGreetingContent,shouldShowSayHello:o.sayHelloMessage&&o.sayHelloMessage.length>0,sayHelloMessage:o.sayHelloMessage};}},componentDidMount:function l(){c('PagesMessagingMercuryChatTabActions').requestGreetingConfig(this.props.threadID);},render:function l(){return (c('React').createElement('div',{className:!this.state.shouldShow&&!this.state.shouldShowSayHello?"hidden_elem":''},this.state.shouldShow?this.state.message:null,this._renderSayHello()));},_onSayHelloClick:function l(){c('PagesMessagingMercuryChatTabActions').sayHello(this.props.threadID);},_renderSayHello:function l(){if(!this.state.shouldShowSayHello)return null;var m=i._("Say '{message}'",[i.param('message',this.state.sayHelloMessage)]);return (c('React').createElement(c('XUIButton.react'),{className:this.state.shouldShow?"_3-8x":undefined,label:m,onClick:this._onSayHelloClick,size:'xlarge'}));}});f.exports=k;}),null);